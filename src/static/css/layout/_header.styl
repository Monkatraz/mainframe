@require '_lib'

// Header Layout
:root
  --layout-header-height: 8rem
  --layout-top-max-width: 60rem

  // Layout for smaller devices
  +match-media(thin, below) 
    --layout-header-height: 6rem
    --layout-top-max-width: 60rem

#header
  height: var(--layout-header-height)
  grid-kiss:"+-------------+ +----------------------------------+ +-----------+",
            "|             | |                 v                | |           |",
            "|             | |           #header_logo           | |           |",
            "|             | |                 ^                | |           |",
            "+-------------+ +----------------------------------+ +-----------+",
            "| 5vh - 0.5fr | |  vm(auto, layout-top-max-width)  | | 5vh - 2fr |"

  // Centered logo
  +match-media(thin, below)
    grid-kiss:"+-----+ +--------------+ +-----+",
              "|     | |      v       | |     |",
              "|     | | #header_logo | |     |",
              "|     | |      ^       | |     |",
              "+-----+ +--------------+ +-----+",
              "| 1fr | |     auto     | | 1fr |"

// Header Logo Internal Grid
#header_logo
  position: absolute
  top: 50%
  transform: translateY(-50%)
  font-size: 1rem
  grid-kiss:"+-----------------------+        +--------------+ ------ ",
            "| #logo_emblem          |        |              |  1fr   ",
            "|                       |        +--------------+ ------ ",
            "|                       |        +--------------+ ------ ",
            "|                       |        | #logo_title  |  3rem  ",
            "|                       |        +--------------+ ------ ",
            "|                       |        +--------------+ ------ ",
            "|                       |        | #logo_slogan |  1rem  ",
            "|                       |        +--------------+ ------ ",
            "|                       |        +--------------+ ------ ",
            "|                       |        |              | 0.75fr ",
            "+-----------------------+        +--------------+ ------ ",
            "|         7rem          | 0.5rem |     auto     |        "

  #logo_emblem, #logo_title, #logo_slogan
    pointer-events: none

  #logo_link
    position: absolute
    top: 50%
    left: 50%
    transform: translate(-50%, -50%)
    width: 100%
    height: 100%

  #logo_emblem
    height: 7rem
    width: 7rem

  // Emblem appears looming behind the text
  +match-media(thin, below)
    position: absolute
    top: 50%
    left: 50%
    transform: translate(-50%, -50%)
    grid-kiss:"+------------------+ ------ ",
              "|                  |  1rem  ",
              "+------------------+ ------ ",
              "+------------------+ ------ ",
              "| > #logo_title  < |  3rem  ",
              "+------------------+ ------ ",
              "+------------------+ ------ ",
              "| > #logo_slogan < |  1rem  ",
              "+------------------+ ------ ",
              "+------------------+ ------ ",
              "|                  | 0.5rem ",
              "+------------------+ ------ ",
              "|       auto       |        "

    #logo_emblem
      position: absolute
      top: 50%
      left: 50%
      transform: translate(-50%, -50%)
      height: 21rem
      width: 21rem

// Header Styling
:root
  $bg-terminaleffect = repeating-linear-gradient(0deg, rgba(black,0.1) 0, rgba(black,0.1) 2px, transparent 0, transparent 4px)
  // Eased gradient shenanigans
  b(n1, n2 = n1)
    col = n1 * 2.55
    return (rgb(col,col,col) unit(n2, '%'))
  $bg-list = b(0,0),b(15,10),b(25,25),b(40,35),b(50,45),b(60,55),b(70,65),b(80,75),b(100)
  $bg-luminosity = 'linear-gradient(180deg, %s)' % unquote(join(',', $bg-list))
  // Stacked backgrounds so that the accent color can be changed without affecting the gradient luminosity
  --header-background: $bg-terminaleffect, $bg-luminosity
  --header-background-color: colvar('accent-1')

#header
  contain: strict
  background: var(--header-background)
  box-shadow: 0 3px 5px rgba(0,0,0,0.5)

  // Background color layer
  &::before 
    content: ""
    position: absolute
    top: 0
    left: 0
    width: 100%
    height: 100%
    background: var(--header-background-color)
    mix-blend-mode: multiply

#logo_emblem
  filter: drop-shadow(0 0 10px rgba(black, 0.5))

#header_logo
  z-index: 1
  color: white
  filter: none
  transition: filter 0.1s

  +on-hover()
    filter: drop-shadow(0 0 5px white)

  // Simple click effect
  &:active
    filter: brightness(80%)
    transition: filter 0s

#logo_title
  margin: 0
  padding: 0
  terminal-text()
  white-space: nowrap
  word-spacing: -0.25rem
  font-size: 3rem
  line-height: @font-size - 1rem
  font-family: 'Title Font', var(--font-mono)
  font-weight: 400

  +match-media(narrow, only)
    font-size: 2.5rem

#logo_slogan
  white-space: nowrap
  letter-spacing: 1px
  font-weight: 600
  font-size: 1rem
  line-height: 0
  // Slight padding if we're not using the centered view
  +match-media(thin, up)
    padding-left: 0.375rem

// Small displays
+match-media(thin, below)
  #logo_emblem
    opacity: 0.35
    filter: drop-shadow(0 0 3px white)

  #logo_slogan
    text-shadow: 0 1px 3px black

  #logo_title, #logo_slogan
    filter: drop-shadow(0 0 4px rgba(0,0,0,0.5))